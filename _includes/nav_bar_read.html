{% assign class-link = 'class="
  font-semibold rounded-full hover:bg-[var(--color-custom-hover)] py-1 text-center whitespace-nowrap px-2 text-sm sm:text-base transition-colors bg-fade
  "' %}


<div class="fixed left-1/2 -translate-x-1/2 bottom-4 z-50 sm:top-4 sm:bottom-auto w-full max-w-4xl w-sm sm:w-full px-10 sm:px-40">
  <div id="nav-bar" class="flex h-10 sm:h-12 rounded-full items-center justify-between px-5 w-full z-50 bg-[var(--color-nav-bg)]">
    
    <!-- Кнопка "назад" -->
    <button onclick="goToPreviousPage()" {{ class-link }}>
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24">
        <path d="M19 12H5M5 12l7 7M5 12l7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>

    <!-- Кнопка "Содержание" -->
    {% if content contains '<h' %}
      <div class="flex-1 flex justify-center">
        <button id="dropdownButton" type="button" {{ class-link }} >
          СОДЕРЖАНИЕ
        </button>
      </div>
    {% else %}
      <span class="flex-1 flex justify-center text-sm opacity-60">СОДЕРЖАНИЯ НЕТ</span>
    {% endif %}

    <!-- Блок действий справа -->
      <div class="flex items-center space-x-1">
        <button
          id="heart-btn"
          {{ class-link }}
          onclick="toggleHeart(this)">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24">
            <path d="M9.04 12.34l-0.31 4.37c0.45 0 0.65-0.19 0.89-0.42l2.14-2.04 4.44 3.24c0.81 0.45 1.39 0.21 1.6-0.75l2.9-13.36c0.26-1.18-0.43-1.64-1.21-1.36l-17.02 6.56c-1.16 0.45-1.15 1.1-0.2 1.39l4.36 1.36 10.13-6.38c0.48-0.3 0.92-0.13 0.56 0.17l-8.2 7.41z" fill="currentColor"/>
          </svg>
        </button>
      </div>
  </div>
</div>

  <div id="heartModal" class="modal-overlay" onclick="closeModal()">
    <div
      class="modal-content mx-4 w-auto max-w-sm sm:max-w-md lg:max-w-lg p-6 sm:p-8 lg:p-10 rounded-2xl sm:rounded-3xl bg-white flex flex-col items-center shadow-2xl"
      onclick="event.stopPropagation()"
    >
      <!-- QR-код - скрыт на мобильных для экономии места -->
      <div class="w-24 h-24 lg:w-32 lg:h-32 mb-4 lg:mb-6 flex items-center justify-center bg-gray-100 rounded-xl hidden sm:flex">
        <img src="/resources/data/qr/telegram_channel.png"
          alt="QR Telegram"
          class="w-20 h-20 lg:w-28 lg:h-28 object-contain"
        />
      </div>

      <!-- Привлекательная надпись - адаптивные размеры -->
      <h3 class="mb-3 text-gray-900 text-xl sm:text-2xl lg:text-3xl font-extrabold text-center leading-tight tracking-tight">
        Присоединяйтесь к нашему Telegram!
      </h3>
      <p class="mb-5 sm:mb-6 text-gray-700 text-center text-sm sm:text-base lg:text-lg font-base leading-relaxed px-2">
        Получайте быстрые ответы, делитесь идееями и находите решения вместе с экспертами.
        <span class="block mt-2 font-semibold text-gray-800">Ваш успех — наша миссия!</span>
      </p>

      <!-- Кнопка Telegram - компактнее на мобильных -->
      <a href="https://t.me/{{ site.telegram }}" target="_blank" rel="noopener noreferrer"
        class="flex items-center justify-center gap-2 bg-[#2AABEE] hover:bg-[#229fdc] active:bg-[#1e90c7] text-white font-semibold px-5 sm:px-6 py-2.5 sm:py-3 rounded-xl sm:rounded-full text-base sm:text-lg transition-colors duration-200 mb-3 sm:mb-4 w-full sm:w-auto min-w-[200px]"
      >
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="20" height="20" sm:width="24" sm:height="24" viewBox="0 0 24 24" class="flex-shrink-0">
          <path d="M9.04 12.34l-0.31 4.37c0.45 0 0.65-0.19 0.89-0.42l2.14-2.04 4.44 3.24c0.81 0.45 1.39 0.21 1.6-0.75l2.9-13.36c0.26-1.18-0.43-1.64-1.21-1.36l-17.02 6.56c-1.16 0.45-1.15 1.1-0.2 1.39l4.36 1.36 10.13-6.38c0.48-0.3 0.92-0.13 0.56 0.17l-8.2 7.41z" fill="currentColor"/>
        </svg>
        Перейти в Telegram
      </a>

      <!-- Кнопка закрытия -->
      <button
        onclick="closeModal()"
        class="mt-2 bg-gray-200 hover:bg-gray-300 active:bg-gray-400 text-gray-700 border-none py-2 px-4 sm:px-6 rounded-lg cursor-pointer text-sm sm:text-base font-semibold transition-colors duration-200"
      >
        Закрыть
      </button>
    </div>
  </div>

<!-- Выпадающая панель вне навбара -->
<div id="dropdownPanel" class="hidden" style="position:fixed; left:0; top:0; width:100vw; z-index:9999;">
  <div class="fixed left-1/2 -translate-x-1/2 bottom-18 z-50 sm:top-18 sm:bottom-auto w-full max-w-4xl w-sm sm:w-full px-10 sm:px-40 pointer-events-none">
    <div class="flex rounded-3xl items-center justify-center px-5 w-full z-50 bg-[var(--color-nav-bg)] pointer-events-auto">
      <div class="p-1 flex flex-col w-full">
        {% assign headings = content | split: '<h1' %}
        {% for heading in headings %}
          {% if forloop.first == false %}
            {% assign heading_parts = heading | split: '>' %}
            {% if heading_parts.size > 1 %}
              {% assign heading_rest = heading_parts[1] %}
              {% assign heading_content = heading_rest | split: '</h1' | first | strip_html | strip %}
              {% if heading_content != '' %}
                {% assign heading_id = heading_content | slugify %}
                <a href="#{{ heading_id }}" class="block w-full px-4 py-2 text-sm text-center hover:bg-[var(--color-custom-hover)] rounded-full m-1 transition-colors duration-200 no-underline focus:bg-[var(--color-custom-hover)] focus:outline-none bg-fade" onclick="closeDropdown()">{{ heading_content }}</a>
              {% endif %}
            {% endif %}
          {% endif %}
        {% endfor %}
      </div>
    </div>
  </div>
</div>

